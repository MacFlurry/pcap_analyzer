PCAP Analyzer a √©t√© install√© avec succ√®s ! üéâ

üìä Application d'analyse de fichiers PCAP avec interface web moderne
Version: {{ .Chart.AppVersion }}

{{- if .Values.persistence.enabled }}
üíæ Stockage persistant activ√© ({{ .Values.persistence.size }})
{{- else }}
‚ö†Ô∏è  Stockage persistant d√©sactiv√© - les donn√©es seront perdues au red√©marrage du pod
{{- end }}

üöÄ Pour acc√©der √† l'application :

{{- if .Values.ingress.enabled }}

  üåê Ingress configur√©:
  {{- range .Values.ingress.hosts }}
  - http://{{ .host }}{{ (index .paths 0).path }}
  {{- end }}

  üìù Assurez-vous d'avoir ajout√© l'entr√©e dans /etc/hosts :
  {{- range .Values.ingress.hosts }}
  echo "127.0.0.1 {{ .host }}" | sudo tee -a /etc/hosts
  {{- end }}

{{- else if eq .Values.service.type "NodePort" }}
  export NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "pcap-analyzer.fullname" . }})
  export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")

  URL: http://$NODE_IP:$NODE_PORT

  {{- if .Values.service.nodePort }}
  Ou directement (si kind avec port mapping): http://localhost:8000
  {{- end }}
{{- else if eq .Values.service.type "LoadBalancer" }}
  NOTE: Le LoadBalancer peut prendre quelques minutes pour obtenir une IP externe.

  export SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "pcap-analyzer.fullname" . }} --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
  echo "URL: http://$SERVICE_IP:{{ .Values.service.port }}"
{{- else if eq .Values.service.type "ClusterIP" }}
  kubectl --namespace {{ .Release.Namespace }} port-forward svc/{{ include "pcap-analyzer.fullname" . }} 8000:{{ .Values.service.port }}
  URL: http://127.0.0.1:8000
{{- end }}

üìã Commandes utiles :

  ‚ö†Ô∏è  IMPORTANT: S√©lection du bon pod
  Les pods app et database partagent certains labels. Pour cibler l'application (pas PostgreSQL):

  # Option 1: Utiliser le nom du deployment (recommand√©)
  kubectl logs -n {{ .Release.Namespace }} deployment/{{ include "pcap-analyzer.fullname" . }} -f

  # Option 2: Utiliser un s√©lecteur de labels excluant la database
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "pcap-analyzer.name" . }},app.kubernetes.io/component!=database -f

  # Option 3: Cibler le pod par son nom complet
  POD_NAME=$(kubectl get pods -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "pcap-analyzer.name" . }},app.kubernetes.io/component!=database -o jsonpath='{.items[0].metadata.name}')
  kubectl logs -n {{ .Release.Namespace }} $POD_NAME -f

  # V√©rifier le statut de tous les composants
  kubectl get all -n {{ .Release.Namespace }}

  # Health check (utiliser le s√©lecteur pour √©viter de cibler PostgreSQL)
  kubectl exec -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "pcap-analyzer.name" . }},app.kubernetes.io/component!=database -- python -c "import urllib.request; print(urllib.request.urlopen('http://localhost:8000/api/health').read().decode())"

  # Red√©marrer l'application (pas la database)
  kubectl rollout restart deployment/{{ include "pcap-analyzer.fullname" . }} -n {{ .Release.Namespace }}

‚öôÔ∏è  Configuration :

  - Replicas: {{ .Values.replicaCount }} (‚ö†Ô∏è  Limit√© √† 1 - SQLite + stockage local)
  - Image: {{ .Values.image.repository }}:{{ .Values.image.tag }}
  - Max upload: {{ .Values.env.maxUploadSizeMB }} MB
  - R√©tention rapports: {{ .Values.env.reportTTLHours }} heures
  - Taille queue: {{ .Values.env.maxQueueSize }}
  - Log level: {{ .Values.env.logLevel }}

{{- if gt (.Values.replicaCount | int) 1 }}
‚ö†Ô∏è  ATTENTION: L'application ne supporte pas plusieurs replicas !
   SQLite et le stockage local ne permettent pas le scale horizontal.
   Pour scale, migrer vers PostgreSQL + S3/MinIO + Redis.
{{- end }}

üìö Documentation compl√®te :
  https://github.com/MacFlurry/pcap_analyzer

üí° Besoin d'aide ?
  Issues: https://github.com/MacFlurry/pcap_analyzer/issues
