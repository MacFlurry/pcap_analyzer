# Default values for pcap-analyzer
replicaCount: 1

image:
  repository: macflurry/pcap-analyzer
  pullPolicy: IfNotPresent
  tag: "v5.2.4"

service:
  type: ClusterIP  # Changed from NodePort when using Ingress
  port: 8000

ingress:
  enabled: true
  className: nginx
  
  # TLS/SSL Configuration
  tls:
    enabled: true
    # Use staging for testing, production for real deployment
    issuer: letsencrypt-production
    # Certificate secret name (auto-generated by cert-manager)
    secretName: pcaplab-com-tls

  annotations:
    # Force HTTPS redirect
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    # SSL protocols
    nginx.ingress.kubernetes.io/ssl-protocols: "TLSv1.2 TLSv1.3"
    # Proxy body size (for PCAP uploads)
    nginx.ingress.kubernetes.io/proxy-body-size: "500m"  # Match max upload size

  hosts:
    - host: pcaplab.com
      paths:
        - path: /
          pathType: Prefix

persistence:
  enabled: true
  accessMode: ReadWriteOnce
  size: 10Gi
  storageClass: standard  # kind default storage class

resources:
  limits:
    memory: 4Gi
    cpu: "2"
  requests:
    memory: 1Gi
    cpu: "1"

env:
  maxUploadSizeMB: "500"
  reportTTLHours: "24"
  dataDir: "/data"
  logLevel: "INFO"
  maxQueueSize: "5"

# Email configuration (Proton Mail SMTP)
email:
  enabled: true
  smtp:
    host: smtp.protonmail.ch
    port: 587
    tls: true
    from: contact@pcaplab.com
    fromName: "PCAP Analyzer"
  credentials:
    existingSecret: proton-smtp-credentials
    usernameKey: username
    passwordKey: password
  # Application URLs for email templates
  supportEmail: support@pcaplab.com
  appBaseUrl: http://pcaplab.com

# Secret key for JWT tokens (auto-generated if not provided)
secretKey: ""

# PostgreSQL configuration
postgresql:
  enabled: true  # Use PostgreSQL (official image from Docker Hub)

  # External PostgreSQL (use existing database)
  external:
    enabled: false  # Set to true to use external PostgreSQL
    url: ""  # postgresql://user:password@host:port/database

  # Internal PostgreSQL (official postgres image) - used if external.enabled=false
  auth:
    username: pcap
    password: change_me_in_production  # CHANGE THIS IN PRODUCTION!
    database: pcap_analyzer

  image:
    repository: postgres
    tag: 16-alpine
    pullPolicy: IfNotPresent

  persistence:
    enabled: true
    size: 8Gi
    storageClass: standard

  resources:
    limits:
      memory: 512Mi
      cpu: "1"
    requests:
      memory: 256Mi
      cpu: "0.5"
