# ============================================
# PCAP Analyzer - Environment Configuration
# ============================================
# Copy this file to .env and customize for your environment
# DO NOT commit .env to version control

# ============================================
# PostgreSQL Configuration
# ============================================
# Database password (REQUIRED in production)
POSTGRES_PASSWORD=secure_password_here_minimum_16_chars

# Optional: Customize PostgreSQL port (default: 5432)
POSTGRES_PORT=5432

# ============================================
# Application Configuration
# ============================================
# JWT/Session secret key (REQUIRED, minimum 32 characters)
SECRET_KEY=your-jwt-secret-key-minimum-32-chars-please-change-this

# CSRF protection
CSRF_SECRET_KEY=change_me_in_production_csrf_key

# CORS configuration
# Comma-separated list of allowed origins (e.g. http://localhost:3000,http://pcap.local)
# Default is "*" if not set
ALLOWED_ORIGINS=*

# Environment mode: development or production (affects CSRF cookie security)
ENVIRONMENT=development

# Optional: Customize application port (default: 8000)
APP_PORT=8000

# Optional: Customize Adminer port (default: 8080)
ADMINER_PORT=8080

# ============================================
# PCAP Analyzer Settings
# ============================================
# Maximum upload size in MB (default: 500)
MAX_UPLOAD_SIZE_MB=500

# Report time-to-live in hours (default: 24)
REPORT_TTL_HOURS=24

# Storage configuration
DATA_DIR=/data

# ============================================
# Email Configuration (SMTP)
# ============================================
MAIL_ENABLED=false
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_TLS=false
SMTP_SSL=false
MAIL_FROM=contact@pcaplab.com
MAIL_FROM_NAME=PCAP Analyzer
SUPPORT_EMAIL=support@pcaplab.com
APP_BASE_URL=http://pcaplab.com
VALIDATE_CERTS=true


# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL (default: INFO)
LOG_LEVEL=INFO

# Maximum queue size for concurrent analysis (default: 5)
MAX_QUEUE_SIZE=5

# ============================================
# Database URL (Primary configuration)
# ============================================
# The application supports both SQLite (dev) and PostgreSQL (prod)
# SQLite (default for development):
DATABASE_URL=sqlite:///data/pcap_analyzer.db

# PostgreSQL (recommended for production):
# DATABASE_URL=postgresql://username:password@hostname:5432/database_name
# Or use docker-compose defaults:
# DATABASE_URL=postgresql://pcap_user:${POSTGRES_PASSWORD}@postgres:5432/pcap_analyzer

# Note: When using PostgreSQL, run migrations first:
# alembic upgrade head

# ============================================
# Production Security Notes
# ============================================
# 1. Generate strong passwords:
#    - openssl rand -base64 32
#    - python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 2. Generate SECRET_KEY (JWT):
#    - openssl rand -hex 32
#    - python -c "import secrets; print(secrets.token_hex(32))"
#
# 3. Generate CSRF_SECRET_KEY (MUST be different from SECRET_KEY):
#    - python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 4. Set ENVIRONMENT=production for HTTPS-only CSRF cookies
#
# 5. Never commit .env to version control
# 6. Restrict file permissions: chmod 600 .env
# 7. Use different credentials for dev/staging/prod
# 8. Rotate secrets regularly in production
